<template>
  <div class="app-container" :class="{'app-container-isdrag':winDrag.isDrag,'u-s-t-n':winDrag.isDrag}">
    <!--路由组件出口的地方-->
    <router-view v-show="!appData.isShowMenu"/>
    <!-- 拖拽 -->
    <div class="drag-area" @mousedown="handleMouseDown"/>
    <!-- 菜单按钮 -->
    <menu-button @click="showMenu"></menu-button>
    <!-- 菜单 -->
    <transition name="menu">
      <section v-if="appData.isShowMenu" class="menu-container u-s-t-n">
        <!-- 小卖部 -->
        <div class="menu-item-container" @click="onclickJump('/index')">
          <div class="menu-item-icon">
            <svg t="1734259701959" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2134"><path d="M800 403.2h32v249.6h-32zM768 339.2H524.8v-38.4h-25.6v38.4H256v32h512zM256 691.2h505.6v32H256zM640 441.6h57.6v57.6H640zM582.4 505.6h57.6v57.6h-57.6zM691.2 505.6h57.6v57.6h-57.6zM640 576h57.6v57.6H640zM384 448h-51.2v57.6h-57.6v57.6h57.6v57.6H384v-57.6h57.6v-57.6H384zM768 371.2h32v32H768zM768 652.8h32v32H768zM192 403.2h32v249.6H192zM224 371.2H256v32h-32zM224 652.8H256v32h-32z" fill="#ffffff" p-id="2135"></path></svg>
          </div>
          <div class="menu-item-name">敲敲</div>
        </div>
        <!-- 小卖部 -->
        <div class="menu-item-container" @click="onclickJump('/shop')">
          <div class="menu-item-icon">
            <svg t="1734250655785" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11127"><path d="M878.770803 997.184778c-0.084178 2.405078 0-0.180381 0.120254-0.444939-1.503174 2.537357 1.202539-1.467097 0.120253 0.120254-0.216457 0.324685-1.058234 2.104443-0.288609 0.733548s-0.228482 0.228482-0.565193 0.565194-1.875961 1.40697-0.62532 0.613295c1.551275-0.986082-1.286717 0.637346-1.286717 0.637345 0.432914-0.252533 2.224697-0.661396 0 0-0.288609 0.084178-3.078499 0.853803-1.515199 0.493041 1.202539-0.264559-1.202539 0-1.936087 0.072152s-1.53925 0-2.29685 0H150.862002c-0.950006 0-3.186728-0.589244-1.202538 0l-2.044317-0.541142c-2.621535-0.661396 1.202539 0.769625-0.853802-0.444939-1.863935-1.082285-0.372787-0.132279 0 0.204431-0.493041-0.408863-0.91393-0.877853-1.394945-1.298742l-0.62532-0.697472q1.202539 1.635453 0.541142 0.541142c-0.565193-0.132279-0.649371-2.296849-0.372787-0.62532 0.348736 2.092418-0.444939-1.779758 0.120254 0.396838 0.168355 0.661396 0 1.370894 0-0.240508v-0.541143-688.730084-3.679769-0.865827-0.204432c-0.084178-2.272798-0.384812 1.202539 0 0s-1.779758 1.791783 0-0.084178c0.336711-0.360762 1.40697-1.803808-0.31266 0.144305 0.420889-0.46899 0.877853-0.901904 1.298742-1.370894 0.62532-0.685447 1.491148-0.661396-0.15633 0.084177a14.141857 14.141857 0 0 0 1.71963-0.998107c-1.563301 1.058234-0.841777 0.264559 0 0s1.394945-0.324685 2.044316-0.541142c-2.056341 0.709498 0.264559 0 1.202539 0H872.986591c0.577219 0 1.202539 0.060127 1.71963 0.072152 1.743681 0-1.527224-0.62532 0 0.072152 0.769625 0.348736 1.707605 0.444939 2.501281 0.769625-0.46899-0.180381-2.032291-0.974056-0.132279 0.096203s-0.432914-0.817726 0.336711 0.120254a9.692463 9.692463 0 0 0 1.346843 1.334818c1.491148 1.202539-2.020265-1.948113 0 0.204432 0.481016 0.505066 0.589244 2.104443-0.144304-0.360762 0.252533 0.865828 0.060127 1.803808 0.072152-0.493041v694.887083c0 6.289278 5.531679 12.313998 12.025389 12.025389a12.22982 12.22982 0 0 0 12.025388-12.025389V305.255941c0-13.30008-8.417772-24.664072-21.645699-27.82675-8.237391-1.960138-17.653271-0.998107-26.046992-0.998107H152.184795c-15.729208 0-30.48436 10.017149-31.061579 26.804592-0.060127 1.875961 0 3.775972 0 5.663958v686.469311c0 15.416548 11.303865 26.612185 26.455855 28.355866a68.797248 68.797248 0 0 0 7.912706 0.252533h716.232148c15.77731 0 30.472335-9.993098 31.097655-26.792566 0.240508-6.289278-5.700034-12.313998-12.025389-12.025388a12.277922 12.277922 0 0 0-12.025388 12.025388z" stroke-width="50" stroke="#ffffff" fill="#ffffff" p-id="11128"></path><path d="M285.810914 361.775267v-109.779773a33.863494 33.863494 0 0 0 0-4.35319v-0.324686c0-0.108228 0.637346-4.497495-0.132279 1.010133-0.348736 2.525332 0.252533-1.479123 0.360761-2.176595q1.046209-6.734218 2.260773-13.444385a626.522749 626.522749 0 0 1 28.860933-104.88544q4.665851-12.686785 9.812717-25.181164l1.202539-2.994321c0.276584-0.649371 1.202539-2.982296 0.456965-1.118361q1.370894-3.23483 2.765839-6.457634 2.693687-6.193075 5.495603-12.350074 11.327916-24.844453 24.30331-48.895231 3.198753-5.952567 6.49371-11.857033H346.923939c2.982296 5.002562 6.18105 9.860819 8.730432 15.103888l20.767846-12.133617c-1.623427-2.212672-3.210779-4.461419-4.653825-6.794344-0.721523-1.202539-1.40697-2.405078-2.032291-3.607617q-0.46899-0.91393-0.889879-1.85191 0.805701 1.948113 0.060127 0l-21.98241 9.295626c10.82285 18.735556 21.020379 37.783771 30.183725 57.373129q3.319007 7.094979 6.445609 14.286162 0.889879 2.056341 1.767732 4.112683c-0.925955-2.200646 0.553168 1.346844 0.721523 1.767732q1.599377 3.872175 3.126601 7.780426 5.880415 15.043761 10.630444 30.496386a12.3621 12.3621 0 0 0 11.592474 8.826635q68.352309 1.815834 136.740695 1.202539 17.31656-0.168355 34.633119-0.493041 8.417772-0.15633 16.763392-0.348736c6.421558-0.144305 14.731101 0.925955 20.515313-2.14052 6.084847-3.222804 7.804477-11.44817 9.620311-17.557067 1.467097-4.882308 2.741789-9.812717 4.365216-14.646923 0.396838-1.202539 0.829752-2.405078 1.274691-3.607617 0.216457-0.565193 1.082285-1.924062 0 0 0.252533-0.444939 0.444939-0.91393 0.685447-1.358869 1.202539-2.272798 2.609509-4.425343 3.968379-6.589913 3.198753-5.074714 5.026612-10.97918 7.215233-16.570985 1.058234-2.753814 2.128494-5.507628 3.234829-8.237392l0.62532-1.539249c0.108228-0.252533 1.202539-2.958246 0.673422-1.623428s0.216457-0.481016 0.264559-0.589244l1.118361-2.525332c2.489255-5.495603 5.435476-10.714621 8.417772-15.981741 6.084847-10.943104 11.784881-22.090639 18.038083-32.949565h-20.839999c3.018373 5.038638 6.361431 9.872844 8.742458 15.260218l18.891886-14.574771c1.948113 2.513306-0.613295-0.93798-0.937981-1.40697-0.769625-1.130387-1.515199-2.272798-2.212671-3.439261s-1.298742-2.405078-1.948113-3.607617-0.565193-1.202539 0 0.204432q-0.324685-0.853803-0.589244-1.731656l-21.982411 9.271574c0.372787 0.649371 1.875961 4.124708 0.7576 1.07026l21.98241-9.271575a9.079168 9.079168 0 0 1-0.962031-1.479123q0.853803 2.272798 0.204432 0.408864l-21.982411 9.271574c8.201315 16.041868 17.412763 31.542594 25.590027 47.596489 2.032291 3.992429 4.004454 8.020934 5.86839 12.085515q0.673422 1.467097 1.322793 2.934195l0.649371 1.479123c0 0.132279 0.769625 1.767732 0.240507 0.541142s0.168355 0.408863 0.228483 0.541143l0.613295 1.491148q0.697473 1.743681 1.370894 3.487363c1.599377 4.184835 2.898119 8.417772 4.32914 12.69881 1.659504 4.894333 4.473445 9.512082 6.553837 14.262111 0 0.108228 0.757599 1.779758 0.252533 0.577219s0.192406 0.46899 0.240508 0.589244c0.408863 1.022158 0.817726 2.032291 1.202539 3.054448q1.298742 3.319007 2.525331 6.674091c1.563301 4.293064 3.042423 8.610178 4.509521 12.939318 2.970271 8.81461 6.012694 17.593144 8.718407 26.455855a526.255058 526.255058 0 0 1 13.732993 56.290845q1.310767 7.058903 2.405078 14.153882 0.529117 3.39116 1.010133 6.794345l0.240508 1.695579c0-0.216457-0.228482-1.791783 0-0.372787 0.072152 0.565193 0.192406 1.202539 0.216457 1.707606v77.142868c0 12.722861-0.288609 25.481799 0 38.192634v0.62532c0 6.289278 5.531679 12.313998 12.025388 12.025389a12.22982 12.22982 0 0 0 12.025389-12.025389v-110.441169a139.722991 139.722991 0 0 0-2.272799-21.6457c-5.916491-37.940101-16.498833-74.930197-29.762836-110.922184-1.815834-4.918384-3.775972-9.776641-5.844339-14.598822q-1.298742-3.018373-2.693687-6.012695-0.697473-1.491148-1.431022-2.958245c-0.240508-0.493041-0.481016-0.986082-0.745574-1.467098-0.793676-1.431021 0.264559 1.467097 0-0.132279-0.757599-4.401292-2.982296-9.019041-4.605724-13.227927q-2.825966-7.215233-6.012694-14.226035c-7.539919-16.546935-16.739341-32.240067-25.385595-48.221809q-3.210779-5.940542-6.301304-11.953236c-2.717738-5.327247-9.812717-7.11903-15.01971-4.918384s-8.886762 8.417772-6.9627 14.189959a25.133062 25.133062 0 0 0 3.174702 6.818395c3.607617 4.894333 9.139295 7.395614 15.019711 4.918384 5.122816-2.16457 9.043092-8.538026 6.9627-14.189959a45.32369 45.32369 0 0 0-3.174703-6.818395A12.025389 12.025389 0 0 0 664.466352 0.953481c-5.291171 2.236722-8.802584 8.417772-6.9627 14.189959 2.489255 7.756376 6.914598 14.201984 11.832982 20.57544 3.607617 4.713952 11.568424 4.208886 15.789335 0.93798 5.074714-3.920277 5.55573-9.932971 3.102551-15.512751-2.405078-5.387374-5.724085-10.22158-8.742458-15.260219-4.593698-7.684223-16.222249-7.912706-20.767846 0-5.796237 10.077276-11.063358 20.310881-16.619087 30.46031a283.41436 283.41436 0 0 0-15.284269 31.57867c-1.984189 4.978511-3.872175 10.005123-5.832314 14.99566l-0.817726 2.080392q0.589244-1.791783-0.360762 0a30.917274 30.917274 0 0 0-2.248748 3.607617 54.823747 54.823747 0 0 0-3.403185 6.229151 123.861503 123.861503 0 0 0-6.012694 17.268458c-0.697473 2.405078-1.394945 4.906359-2.152544 7.335487-0.432914 1.38292-0.877853 2.765839-1.358869 4.124709q-0.360762 1.022158-0.745574 2.03229-0.91393 2.3209 0.252533-0.62532l4.317114-4.317114c2.958246-2.092418 5.014587-0.950006 2.405078-1.010133-0.793676 0-1.599377 0-2.405078 0.060127l-4.810155 0.120254-10.185504 0.228482q-9.872844 0.216457-19.733663 0.372787-19.697587 0.324685-39.395173 0.432914-39.359097 0.228482-78.718194-0.360761-22.150766-0.336711-44.289507-0.925955l11.592475 8.826635c-13.059572-42.702155-33.081844-82.975182-55.316788-121.564654a12.025389 12.025389 0 0 0-15.01971-4.918384c-5.11079 2.152545-9.043092 8.538026-6.9627 14.189959a73.030185 73.030185 0 0 0 9.944996 17.977956c3.70382 5.062689 10.606393 8.081061 16.450732 4.317114s7.215233-10.389936 4.317114-16.450731c-2.549382-5.243069-5.748136-10.101326-8.730432-15.103889-4.533572-7.612071-16.318452-7.984858-20.767846 0a827.262561 827.262561 0 0 0-47.836996 100.941113 642.155754 642.155754 0 0 0-31.266011 104.620881q-2.801916 13.600715-4.942434 27.321683a59.369344 59.369344 0 0 0-1.082285 9.115245v72.825753c0 13.131724-0.276584 26.299525 0 39.443275v0.637346c0 6.289278 5.531679 12.313998 12.025388 12.025388a12.22982 12.22982 0 0 0 12.025389-12.025388zM644.239648 581.7076a70.288397 70.288397 0 1 1-125.064042 36.3287l-2.982296 5.194967 1.262665-0.649371-9.043092-5.194967a70.25232 70.25232 0 0 1-57.517434 76.445395c-34.741348 6.49371-69.927635-15.452624-79.872631-49.219916a70.793463 70.793463 0 0 1 12.241845-63.566204c2.020265-2.537357 2.47723-6.012694 0-8.50195-2.092418-2.092418-6.469659-2.549382-8.501949 0a83.648603 83.648603 0 0 0-17.232382 66.945339 82.385938 82.385938 0 0 0 86.823306 67.209897 82.229608 82.229608 0 0 0 76.060583-89.336612c-0.408863-4.617749-4.810155-7.383589-9.043092-5.194968-2.982296 1.527224-4.040531 3.499388-4.341166 6.866497a72.537144 72.537144 0 0 0-0.192406 9.620311 85.199879 85.199879 0 0 0 2.200646 15.885538 80.726434 80.726434 0 0 0 12.301973 27.490039 82.30176 82.30176 0 0 0 146.613538-23.172924c7.852579-26.191296 1.683554-54.414884-15.212116-75.65172-2.020265-2.537357-6.385481-2.116468-8.50195 0-2.513306 2.513306-2.032291 6.012694 0 8.501949z" stroke="#ffffff" stroke-width="50" fill="#ffffff" p-id="11129"></path></svg>
          </div>
          <div class="menu-item-name">小卖部</div>
        </div>
        <!-- 包裹 -->
        <div class="menu-item-container" @click="onclickJump('/item')">
          <div class="menu-item-icon">
            <svg t="1734266099191" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5399"><path d="M960 253.184l-448-192-448 192v547.392l448 190.72 38.688-16.48h8.192v-3.488L960 800.608V253.184z m-448 163.424l-113.536-48.32 318.944-147.2c0.736-0.352 1.216-0.992 1.92-1.408l127.232 54.528L512 416.608z m128.704-230.624l-321.696 148.48-141.568-60.288L512 130.816l128.704 55.168zM128 322.688l128 54.496V576a32 32 0 1 0 64 0v-171.52l0.064-0.032 174.816 74.432v435.584L128 758.272V322.688z m430.88 579.104V466.208L896 322.688v435.616l-337.12 143.488z" p-id="5400" fill="#ffffff"></path></svg>
          </div>
          <div class="menu-item-name">包裹</div>
        </div>
        <!-- 统计 -->
        <div class="menu-item-container" @click="onclickJump('/record')">
          <div class="menu-item-icon">
            <svg t="1734252576868" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6620"><path d="M387.289674 263.516696c-17.246803 0-31.221072 13.974269-31.221072 31.221072l0 31.220049c0 17.246803 13.974269 31.221072 31.221072 31.221072s31.220049-13.974269 31.220049-31.221072l0-31.220049C418.509722 277.490965 404.536476 263.516696 387.289674 263.516696z" fill="#ffffff" p-id="6621"></path><path d="M637.054157 263.516696c-17.246803 0-31.221072 13.974269-31.221072 31.221072l0 31.220049c0 17.246803 13.974269 31.221072 31.221072 31.221072s31.221072-13.974269 31.221072-31.221072l0-31.220049C668.274206 277.490965 654.299937 263.516696 637.054157 263.516696z" fill="#ffffff" p-id="6622"></path><path d="M588.933183 401.13296c-14.522762-9.28855-33.822316-5.081739-43.131333 9.451256-0.121773 0.193405-13.374612 19.441794-33.954323 19.441794-19.980054 0-32.410154-18.090007-33.253358-19.35993-9.166777-14.421454-28.243251-18.801205-42.816155-9.766434-14.644535 9.106402-19.147082 28.354791-10.050913 42.999326 11.209296 18.038842 41.952484 48.569182 86.120426 48.569182 43.934628 0 75.063603-30.296003 86.536912-48.202838C607.683223 429.751764 603.455945 410.432767 588.933183 401.13296z" fill="#ffffff" p-id="6623"></path><path d="M866.426195 172.243923c-1.137916-0.020466-2.225691-0.020466-3.353374 0.010233l-66.181305 0L796.891516 110.066815c0-17.246803-13.974269-31.220049-31.220049-31.220049L375.210567 78.846766c-17.246803 0-31.220049 13.974269-31.220049 31.220049s13.974269 31.220049 31.220049 31.220049l359.239827 0 0 306.981626c0 122.463146-99.627045 222.100424-222.091214 222.100424s-222.091214-99.637278-222.091214-222.100424l0-338.202699c0-17.246803-13.974269-31.220049-31.220049-31.220049s-31.220049 13.974269-31.220049 31.220049l0 62.187341-66.567092 0c-1.14815-0.040932-2.347464-0.020466-3.882424 0-51.221592 0-92.889597 41.678238-92.889597 92.910063 0 24.695448 9.593496 47.918359 27.02347 65.459874l135.502114 145.919371c0.757247 0.816598 1.638313 1.429559 2.459005 2.145873 14.134929 132.37489 119.401414 237.868549 251.665787 252.374938l0 152.291498L337.659323 883.354749c-17.246803 0-31.220049 13.974269-31.220049 31.220049s13.974269 31.221072 31.220049 31.221072l349.401762 0c17.246803 0 31.220049-13.974269 31.220049-31.221072s-13.974269-31.220049-31.220049-31.220049L543.580253 883.354749 543.580253 731.063251c132.3841-14.520715 237.729379-120.18936 251.710812-252.734118 0.674359-0.610914 1.416256-1.107217 2.047636-1.786693L932.840814 330.62307c17.428951-17.541515 27.013237-40.753169 27.013237-65.459874C959.854051 213.932394 918.186046 172.254156 866.426195 172.243923zM136.869251 287.714817c-0.294712-0.315178-0.589424-0.620124-0.89437-0.925069-5.833869-5.792936-9.045003-13.465686-9.045003-21.626553 0-16.799618 13.659091-30.468942 30.448476-30.468942l1.564635-0.051165c0.568958 0.030699 1.14815 0.051165 1.717108 0.051165l67.166749 0 0 150.971433L136.869251 287.714817zM888.37816 286.789749c-0.304945 0.304945-0.599657 0.60989-0.89437 0.925069l-90.592274 97.556896L796.891516 234.695277l66.791196 0c0.568958 0 1.016143 0.020466 1.574868-0.020466l1.706875 0.020466c16.789385 0 30.448476 13.669324 30.448476 30.468942C897.41293 273.324062 894.201795 281.007045 888.37816 286.789749z" fill="#ffffff" p-id="6624"></path></svg>
          </div>
          <div class="menu-item-name">统计</div>
        </div>
        <!-- 系统设置 -->
        <div class="menu-item-container">
          <div class="menu-item-icon" @click="onclickJump('/system')">
            <svg t="1734250601632" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8671"><path d="M45.077333 431.402667H21.333333V104.661333A83.328 83.328 0 0 1 104.661333 21.333333h326.741334v23.744c0 213.354667-172.970667 386.325333-386.325334 386.325334zM943.509333 543.274667l-53.44-3.925334a33.109333 33.109333 0 0 1-29.162666-23.168 208.448 208.448 0 0 0-22.378667-48.64 33.066667 33.066667 0 0 1 0.192-35.392l27.754667-43.285333c8.448-13.141333 5.269333-31.530667-6.890667-40.170667l-44.181333-31.338666a22.976 22.976 0 0 0-17.749334-3.968c-6.592 1.28-12.330667 5.333333-16.234666 11.392l-27.754667 43.285333a33.024 33.024 0 0 1-34.730667 14.506667 179.370667 179.370667 0 0 0-48.469333-3.605334c-13.994667 0.512-26.282667-6.784-31.957333-19.093333l-20.757334-44.757333a26.026667 26.026667 0 0 0-14.976-13.994667 22.4 22.4 0 0 0-17.834666 1.28l-47.786667 24.576c-13.077333 6.677333-18.517333 24.341333-11.946667 38.549333l20.672 44.458667a33.130667 33.130667 0 0 1-5.205333 35.861333 164.970667 164.970667 0 0 0-15.168 20.352 205.930667 205.930667 0 0 0-13.184 24.021334 32.938667 32.938667 0 0 1-32.384 18.986666l-44.8-3.264a23.402667 23.402667 0 0 0-17.173333 5.866667 28.650667 28.650667 0 0 0-9.642667 20.053333l-3.669333 55.957334c-1.002667 15.573333 9.536 29.098667 23.509333 30.165333l45.802667 3.392a33.066667 33.066667 0 0 1 28.992 22.741333 206.762667 206.762667 0 0 0 21.482666 45.930667 33.066667 33.066667 0 0 1-0.128 35.498667l-27.754666 43.285333c-8.448 13.141333-5.205333 31.573333 7.018666 40.256l44.16 31.338667c6.762667 4.8 13.354667 4.8 17.621334 3.946666 6.549333-1.28 12.309333-5.333333 16.234666-11.456l27.754667-43.285333a33.024 33.024 0 0 1 34.688-14.506667c16.234667 3.456 32.917333 4.693333 49.557333 3.626667l2.048-0.064c12.821333 0 24.533333 7.402667 29.994667 19.114667l22.869333 49.152c3.136 6.805333 8.426667 11.733333 14.933334 13.973333 4.16 1.429333 10.688 2.368 17.898666-1.322667l47.744-24.490666c13.12-6.72 18.624-24.448 12.053334-38.677334l-23.061334-49.6a33.066667 33.066667 0 0 1 5.056-35.669333 184.896 184.896 0 0 0 26.282667-40.832c5.845333-12.373333 18.432-19.776 32.362667-18.922667l54.570666 4.032c6.122667 0.533333 12.096-1.664 16.96-5.909333 5.781333-5.013333 9.237333-12.224 9.770667-20.309333l3.712-55.701334c1.109333-15.68-9.344-29.248-23.274667-30.250666z m-143.104 117.994666c-21.034667 32.768-53.141333 54.784-90.410666 62.016-8.618667 1.685333-17.28 2.517333-25.856 2.517334a134.741333 134.741333 0 0 1-78.250667-25.237334c-62.826667-44.544-79.594667-134.250667-37.397333-200 21.013333-32.746667 53.098667-54.784 90.368-62.016a134.357333 134.357333 0 0 1 104.170666 22.741334c62.762667 44.501333 79.530667 134.229333 37.376 199.978666zM772.544 643.392h0.213333-0.213333z" fill="#ffffff" p-id="8672"></path><path d="M330.069333 847.573333H109.482667A109.589333 109.589333 0 0 1 0 738.112V109.482667A109.610667 109.610667 0 0 1 109.482667 0h805.034666A109.610667 109.610667 0 0 1 1024 109.482667v167.296a21.333333 21.333333 0 1 1-42.666667 0V109.482667A66.901333 66.901333 0 0 0 914.517333 42.666667H109.482667A66.901333 66.901333 0 0 0 42.666667 109.482667v628.629333a66.901333 66.901333 0 0 0 66.816 66.816h220.586666a21.333333 21.333333 0 1 1 0 42.645333zM557.930667 1024H260.245333a21.333333 21.333333 0 1 1 0-42.666667h297.706667a21.333333 21.333333 0 1 1-0.021333 42.666667z" p-id="8673" fill="#ffffff"></path><path d="M773.589333 905.728c-8.448 0-16.96-1.408-25.216-4.245333a79.786667 79.786667 0 0 1-46.549333-42.538667l-16.896-36.309333c-11.328 0.917333-23.253333-0.832-34.773333-2.538667l-20.074667 31.317333a78.997333 78.997333 0 0 1-51.669333 35.477334 76.650667 76.650667 0 0 1-59.434667-12.970667l-44.202667-31.338667c-35.818667-25.365333-45.397333-76.544-21.354666-114.026666l20.672-32.213334a261.44 261.44 0 0 1-15.317334-32.618666L426.816 661.333333c-43.648-3.242667-76.736-42.709333-73.792-87.957333l3.648-55.957333a82.773333 82.773333 0 0 1 28.224-57.557334 76.864 76.864 0 0 1 56.896-19.093333l30.528 2.218667a254.016 254.016 0 0 1 21.226667-33.109334l-15.061334-32.384c-18.816-40.682667-2.432-89.941333 36.501334-109.824l47.765333-24.576a76.650667 76.650667 0 0 1 60.458667-4.266666 79.765333 79.765333 0 0 1 46.549333 42.56l14.805333 31.978666c11.306667 0.021333 22.549333 0.853333 33.621334 2.474667l20.074666-31.296a78.933333 78.933333 0 0 1 51.648-35.413333 76.885333 76.885333 0 0 1 59.605334 12.992l44.181333 31.338666c35.754667 25.344 45.269333 76.437333 21.226667 113.941334l-20.693334 32.234666c6.4 11.477333 11.925333 23.381333 16.490667 35.626667l39.317333 2.901333c43.690667 3.136 76.778667 42.666667 73.728 88.149334l-3.712 55.701333a83.264 83.264 0 0 1-28.352 57.728 76.693333 76.693333 0 0 1-56.661333 19.114667l-40.448-2.986667a236.586667 236.586667 0 0 1-18.922667 29.226667l17.493334 37.610666c18.773333 40.64 2.368 89.962667-36.565334 109.973334h-0.021333l-47.744 24.469333a77.333333 77.333333 0 0 1-35.242667 8.576z m-75.264-126.208c8.256 0 15.829333 4.778667 19.328 12.330667l22.869334 49.152c4.501333 9.706667 12.202667 16.832 21.76 20.117333 8.96 3.114667 18.602667 2.389333 27.114666-1.984l47.765334-24.469333c18.858667-9.706667 26.624-33.962667 17.322666-54.058667l-23.082666-49.621333a21.354667 21.354667 0 0 1 3.242666-22.976 183.68 183.68 0 0 0 15.658667-21.141334 195.413333 195.413333 0 0 0 12.416-22.421333 21.226667 21.226667 0 0 1 20.885333-12.202667l54.570667 4.010667a34.773333 34.773333 0 0 0 25.557333-8.746667 40.96 40.96 0 0 0 13.781334-28.394666l3.712-55.701334c1.493333-22.101333-13.866667-41.28-34.218667-42.730666l-53.376-3.946667a21.333333 21.333333 0 0 1-18.794667-14.912 222.378667 222.378667 0 0 0-23.68-51.370667 21.354667 21.354667 0 0 1 0.128-22.848l27.776-43.285333c11.925333-18.581333 7.445333-43.733333-9.984-56.085333l-44.181333-31.338667a34.56 34.56 0 0 0-26.794667-5.909333 36.565333 36.565333 0 0 0-23.872 16.576l-27.776 43.285333a21.290667 21.290667 0 0 1-22.421333 9.344 194.688 194.688 0 0 0-51.605333-3.84 20.736 20.736 0 0 1-20.629334-12.309333l-20.757333-44.757334a37.354667 37.354667 0 0 0-21.76-20.138666 34.24 34.24 0 0 0-27.050667 1.92l-47.765333 24.576c-18.858667 9.621333-26.581333 33.792-17.28 53.909333l20.693333 44.501333c3.562667 7.701333 2.24 16.789333-3.392 23.146667a178.453333 178.453333 0 0 0-16.234666 21.781333c-5.12 7.978667-9.792 16.490667-13.930667 25.344a21.866667 21.866667 0 0 1-20.885333 12.266667l-44.8-3.264a35.072 35.072 0 0 0-25.749334 8.725333 40.32 40.32 0 0 0-13.653333 28.138667l-3.648 55.978667c-1.429333 21.973333 13.973333 41.109333 34.368 42.624l45.802667 3.392a21.333333 21.333333 0 0 1 18.709333 14.677333c5.610667 17.216 13.269333 33.536 22.72 48.554667a21.333333 21.333333 0 0 1-0.085333 22.890666l-27.776 43.264c-11.925333 18.581333-7.381333 43.776 10.112 56.192l44.181333 31.338667c7.893333 5.589333 17.258667 7.722667 26.645333 5.866667a36.586667 36.586667 0 0 0 23.872-16.618667l27.776-43.285333a21.226667 21.226667 0 0 1 22.378667-9.344 197.013333 197.013333 0 0 0 54.037333 3.797333z m148.565334 74.133333h0.213333-0.213333z" p-id="8674" fill="#ffffff"></path><path d="M686.805333 703.125333a123.050667 123.050667 0 0 1-71.509333-23.082666c-57.749333-40.917333-73.152-123.498667-34.304-184.042667 19.264-30.037333 48.64-50.218667 82.730667-56.832a122.581333 122.581333 0 0 1 95.125333 20.778667c57.770667 40.96 73.152 123.541333 34.304 184.042666-19.264 30.037333-48.661333 50.218667-82.752 56.832a121.002667 121.002667 0 0 1-23.594667 2.304z m0.405334-223.573333c-5.098667 0-10.218667 0.490667-15.36 1.493333-22.528 4.373333-42.026667 17.856-54.933334 37.973334-26.709333 41.642667-16.362667 98.261333 23.061334 126.229333a80.768 80.768 0 0 0 62.314666 13.717333c22.528-4.373333 42.048-17.877333 54.954667-37.994666 26.709333-41.621333 16.362667-98.24-23.061333-126.208a80.917333 80.917333 0 0 0-46.976-15.210667z" p-id="8675" fill="#ffffff"></path></svg>
          </div>
          <div class="menu-item-name">系统设置</div>
        </div>
        <!-- 退出应用 -->
        <div class="menu-item-container" @click="onclickExit">
          <div class="menu-item-icon">
            <svg t="1734250701430" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="13192"><path d="M761.607758 636.772848c-12.815515 32.023273-35.219394 60.819394-57.623273 86.388364a256 256 0 0 1-86.388364 57.654303c-31.992242 12.784485-67.180606 22.372848-105.596121 22.372849s-73.572848-6.392242-105.596121-22.372849a406.590061 406.590061 0 0 1-86.388364-57.654303 255.720727 255.720727 0 0 1-57.592242-86.388364c-12.846545-31.961212-22.434909-67.211636-22.434909-105.596121 0-22.341818 3.227152-44.776727 6.423272-63.984485 6.361212-22.341818 12.784485-41.580606 22.372849-60.819394 9.619394-19.145697 22.403879-35.157333 35.219394-54.396121A215.350303 215.350303 0 0 1 352.007758 307.2c9.619394-6.423273 19.207758-9.588364 28.796121-6.423273 9.619394 3.258182 19.207758 6.423273 25.6 16.011637 6.423273 9.588364 9.619394 19.238788 6.423273 28.796121-3.227152 9.619394-6.423273 19.176727-16.042667 25.6-25.6 19.207758-47.972848 41.611636-60.788364 70.376727-12.784485 28.858182-22.434909 57.623273-22.434909 89.615515 0 25.6 6.423273 51.2 16.011636 76.8 9.619394 25.6 25.6 44.838788 41.611637 60.819394a187.578182 187.578182 0 0 0 60.819394 41.580606c24.203636 10.550303 50.362182 15.980606 76.768969 16.011637 25.6 0 51.2-6.392242 76.831031-16.011637 25.6-9.588364 44.807758-25.6 60.788363-41.580606a187.578182 187.578182 0 0 0 41.580606-60.819394c10.550303-24.234667 15.980606-50.362182 16.042667-76.8 0-31.961212-6.392242-60.788364-19.176727-86.388363-12.815515-25.6-32.023273-51.2-57.654303-67.211637-9.557333-6.361212-12.784485-15.949576-15.980606-25.6-3.227152-9.588364 0-19.176727 6.423273-28.765091 6.361212-9.619394 15.980606-12.784485 25.6-16.011636 9.588364-3.196121 19.145697 0 28.76509 6.361212A297.890909 297.890909 0 0 1 716.8 358.4c12.784485 16.011636 25.6 35.188364 35.188364 51.2 9.619394 19.176727 16.011636 38.415515 22.434909 57.592242 6.392242 19.207758 6.392242 41.580606 6.392242 63.984485 3.196121 38.415515-3.227152 73.634909-19.207757 105.658182v-0.062061zM473.584485 265.619394c0-9.588364 3.227152-19.176727 12.815515-28.827152 7.478303-7.974788 17.873455-12.567273 28.796121-12.784484 9.619394 0 19.176727 3.258182 25.6 12.784484 8.005818 7.509333 12.629333 17.904485 12.815515 28.858182v230.4c0 9.557333-3.227152 19.207758-12.815515 25.631031-6.423273 6.361212-15.980606 12.722424-25.6 12.722424-9.619394 0-19.207758-3.196121-28.796121-12.784485-6.392242-6.392242-12.815515-16.011636-12.815515-25.6V265.588364zM512 0C230.4 0 0 230.4 0 512S230.4 1024 512 1024 1024 793.6 1024 512 793.6 0 512 0z" fill="#ffffff" p-id="13193"></path></svg>
          </div>
          <div class="menu-item-name">退出应用</div>
        </div>
      </section>
    </transition>
  </div>
</template>

<script setup>
  import { provide,onMounted,reactive,computed } from 'vue'
  import { useRouter,useRoute } from 'vue-router'
  import MenuButton from '@renderer/components/MenuButton/index.vue'
  import useStore from '@renderer/store'
  import { load,save } from '@renderer/utils/file'
  
  const globalStore = useStore().global;
  const router = useRouter();
  const route = useRoute();
  
  const appData = reactive({
    isShowMenu:false,
    event:{
      isRestricted:false,
      timer:null,
      isKeyDown:false,
      isonclick:false
    }
  })
  const proportion = computed(()=>{return globalStore.global.coin / (30 / 7 * globalStore.global.day) / globalStore.global.hour / 60 / 60 / 1000})
  
  //注入appdata
  provide('appData',appData)

  //加载存档
  onMounted(async ()=>{
    if(window.api.loadConfig != null){
      const content = await window.api.loadConfig();
      const global = load(content);
      if(global != false){
        const today = new Date()
        today.setHours(0)
        today.setMinutes(0)
        today.setSeconds(0)
        today.setMilliseconds(0)
        if(global.updateTime == null || today.getTime() > global.updateTime){
          globalStore.global.updateTime = new Date().getTime()
          //Coin Today
          globalStore.global.accumulatedCoin = 0
        }else{
          globalStore.global.updateTime = global.updateTime
          //Coin Today
          globalStore.global.accumulatedCoin = global.accumulatedCoin ?? globalStore.global.accumulatedCoin
        }
        globalStore.global.coin = global.coin ?? globalStore.global.coin
        //Coin Total
        globalStore.global.accumulatedCoinRecord = global.accumulatedCoinRecord ?? globalStore.global.accumulatedCoinRecord
        globalStore.global.nekoCoin = global.nekoCoin ?? globalStore.global.nekoCoin
        globalStore.global.nekoCoinRecord = global.nekoCoinRecord ?? globalStore.global.nekoCoinRecord
        globalStore.global.type = global.type ?? globalStore.global.type
        globalStore.global.item = global.item ?? globalStore.global.item
        globalStore.global.day = global.day ?? globalStore.global.day
        globalStore.global.hour = global.hour ?? globalStore.global.hour
      }
    }
  })
  
  //注册键盘事件
  onMounted(()=>{
    window.api.onkeydownKeyboard((_event, value)=>{
      try{
        globalStore.event.oncontinuekeydown(_event, value)
      }catch{

      }
      try{
        if(!appData.event.isKeyDown){
          const nekoCoin = 1
          globalStore.global.nekoCoin += nekoCoin;
          globalStore.global.nekoCoinRecord += nekoCoin;
          const nekoCoinEvent = {
            nekoCoin
          }
          //Menu关闭后执行
          if(!appData.isShowMenu){
            try{
              globalStore.event.onanykeydown(_event, value, nekoCoinEvent)
            }catch{

            }
          }
          appData.event.isKeyDown = true;
        }
        if(value.keycode == 29 || value.keycode == 42){
          return;
        }
        if(appData.event.timer == null){
          showCoinEvent(_event, value)
          throttle();
        }else{
          appData.event.isonclick = true;
        }
      }catch(e){

      }
    })
    window.api.onkeyupKeyboard((_event, value)=>{
      try{
        appData.event.isKeyDown = false;
        try{
          globalStore.event.onkeyup(_event, value)
        }catch{

        }
      }catch(e){

      }
    })
  })
  function showCoinEvent(_event, value){
    //coin
    const coin = (new Date().getTime() - globalStore.global.updateTime) * proportion.value
    const event = {
      coin
    }
    //Menu关闭后执行
    if(!appData.isShowMenu){
      try{
        globalStore.event.onkeydown(_event, value, event)
      }catch{

      }
    }
    globalStore.global.updateTime = new Date().getTime();
    globalStore.global.accumulatedCoin += coin;
    globalStore.global.accumulatedCoinRecord += coin;
    setTimeout(() => {
      saveFile();
    }, 1000);
  }
  function throttle(){
    if(appData.event.timer != null){
      return;
    }
    appData.event.timer = setTimeout(() => {
      appData.event.timer = null;
      appData.event.isonclick = false;
      if(appData.event.isonclick){
        showCoinEvent();
        throttle();
      }
    }, 233);
  }

  //路由跳转
  async function onclickJump(url){
    if(!route.meta.isCommand){
      //获取窗口坐标 -> origin
      globalStore.win.origin = await window.api.setWinSize()
    }else if(globalStore.win.origin != null){
      //设置窗口坐标 -> origin
      await window.api.setWinSize({...globalStore.win.origin})
    }
    appData.isShowMenu = false
    router.push(url)
  }

  //退出应用
  function onclickExit(){
    saveFile();
    window.api.appExit();
  }

  //保存
  function saveFile(){
    const content = save(globalStore.global)
    if(content != false){
      window.api.writeConfig(content);
    }
  }
  
  //菜单
  function showMenu(){
    appData.isShowMenu = appData.isShowMenu ? false : true
  }

  //窗口拖拽
  const winDrag = reactive({
    isDrag:false
  })
  const handleMouseDown = (e) => {
    if(!winDrag.isDrag){
      winDrag.isDrag = true;
    }
    window.customAPI.publishMainWindowOperateMessage({event: 'homeDragWindowStart'});
  }
  window.addEventListener('mouseup',()=>{
    if(winDrag.isDrag){
      window.customAPI.publishMainWindowOperateMessage({event: 'homeDragWindowEnd'});
      winDrag.isDrag = false;
    }
  })
  
</script>

<style lang="scss" scoped>
  .app-container{
    position: absolute;
    width: 100vw;
    height: 100vh;
    border: rgba(255,255,255,.6) 2px dashed;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 15px;
    box-sizing: border-box;
    .drag-area{
      position: absolute;
      left: 50%;
      transform: translate(-50%,-50%);
      top: 15px;
      height: 6px;
      width: 50px;
      z-index: 0;
      opacity: .45;
      border: rgba(255,255,255,1) 2px solid;
      border-radius: 5px;
      transition: opacity .5s,width .5s;
      &:hover{
        opacity: .85;
        width: 75px;
      }
    }
    // 菜单
    .menu-enter-active{
      animation: aniamtion-menu-in 0.5s;
    }
    @keyframes aniamtion-menu-in {
      0%{
        opacity: 0;
      }
      100%{
        opacity: 1;
      }
    }
    .menu-container{
      position: absolute;
      font-family: 'Uranus_Pixel';
      color: rgba(255,255,255,1);
      margin-top: 30px;
      padding: 0 8px 30px 8px;
      display: flex;
      flex-wrap: wrap;
      .menu-item-container{
        margin-top: 10px;
        height: 60px;
        width: 60px;
        display: flex;
        flex-direction: column;
        align-items: center;
        z-index: 5;
        &:hover{
          .menu-item-icon{
            transform: translateY(-3px);
          }
        }
        .menu-item-icon{
          height: 40px;
          width: 40px;
          border: rgba(255,255,255,1) 1px solid;
          border-radius: 10px;
          cursor: pointer;
          box-sizing: border-box;
          transition: transform .25s;
          display: flex;
          justify-content: center;
          align-items: center;
          svg{
            height: 30px;
            width: 30px;
          }
        }
        .menu-item-name{
          margin-top: 2px;
          font-size: 12px;
        }
      }
    }
  }
  .app-container-isdrag{
    background: rgba(0, 0, 0, .75);
    border: rgba(255,255,255,.1) 2px dashed;
    border-bottom: rgba(255,255,255,.75) 2px solid;
    border-radius: 15px 15px 0 0;
  }
</style>